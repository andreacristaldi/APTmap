<!DOCTYPE html>
 
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="initial-scale=1" />
	<meta name="description" content="APTMalware - Advanced Persistent Threat MALWARE stats">
	<meta name="keywords" content="APTMalware, Advanced Persistent Threat MALWARE stats">
	<meta name="author" content="Andrea Cristaldi">
	<title>APTMalware - Advanced Persistent Threat MALWARE features and statistics</title>
	<link rel="stylesheet" href="CSS/style2.css" />
	<link rel="icon" type="image/x-icon" href="images/favicon.ico">
	<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>




</script>


</head>
<body>
 <div id="container">
  
    <div id="introDiv">
      
      <div id="show-intro">
	  <h1><img src="images/aptmap.png" /><br/>APT Malware features and statistics</h1>
        <p>An Advanced Persistent Threat (APT) is a stealthy computer network threat actor, nation state, state-sponsored group or non-state sponsored groups conducting large-scale targeted intrusions for specific goals, which gains unauthorized access to a computer network and remains undetected for an extended period.
        </p>
		<p>The data reported here are the result of a processing based on static analysis techniques performed on 29GB of malware samples attributed to APT groups, followed by a correlation process. The sample group is limited to PE Portable executable. The data in JSON format are available on the github repository.</p>
		<p>Attribution is a very complex issue. Information published here may be wrong, outdated, or may change based on evolving information.</p>
        <p>Sample sources: <a href="https://www.vx-underground.org/" target="blank_">VX-Underground</a></p>
		<p>ALL DOCUMENTS AND THE INFORMATION CONTAINED THEREIN ARE PROVIDED ON AN "AS IS" BASIS</p>
		<p>Project: <strong style="color:rgb(253, 255, 16);">Andrea Cristaldi</strong> <a href="https://github.com/andreacristaldi/APTmap" target="blank_">GitHub</a>, <a href="https://www.linkedin.com/in/andreacristaldi/" target="blank_">Linkedin</a>, <a href="https://www.cybersec4.com" target="blank_">Cybersec4</a>
		<p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" target="blank_">Creative Commons Attribution 4.0 International License</a>.</p>
		<button id="start">Go to data</button>
      </div>
     
	   
    </div>
  </div>
	<div id="DivContainer">
	<img src="images/aptmap.png"/>
	<h1>APT Malware features and statistics</h1>
		<div class="DivPanel1">
			<h2>Samples</h2>
			<span id="NSamples"></span>
			<p>2010-2022</br>
			PE Portable Executable</br>
			29GB of data analysed using static analysis techniques</br>
			<a href="samples.html">Here, the sample list</a></br></br></p>
			<a href="index.html">Go to APTMap</a></br></br>
		<h3 id="Aboutclickable" >About APTMalware</h3>
		</div>
		
		<div class="DivPanel1">
			<h2>Filesizes</h2>
			<canvas id="IdChartFilesize" ></canvas>
			<script>

document.getElementById("start").addEventListener("click", function () {
	document.getElementById("DivContainer").style.filter = "blur(0px)";
    document.getElementById("container").style.display = "none";
    
    });
	
document.getElementById("Aboutclickable").addEventListener("click", function () {
	document.getElementById("DivContainer").style.filter = "blur(8px)";
    document.getElementById("container").style.display = "";
    
    });
	
	
	var referrer = document.referrer;

    if (referrer.includes("samples.html")) {
        
 document.getElementById("DivContainer").style.filter = "blur(0px)";
 document.getElementById("container").style.display = "none";
      } 

function escapeHTML(unsafe) {
    return unsafe.replace(/[&<"'>]/g, function(match) {
        switch (match) {
            case '&':
                return '&amp;';
            case '<':
                return '&lt;';
            case '>':
                return '&gt;';
            case '"':
                return '&quot;';
            case "'":
                return '&#039;';
            default:
                return match;
        }
    });
}

 function loadData0() {
            $.getJSON('filesizes_count.json', function(data) {
                jsonData0 = data;
                	
				
				
				
	var yValues1 = [];
	var xValues1 = [];
	
	for (const item of jsonData0) {
			xValues1.push(item.count);
			yValues1.push(item.filesize);
                
      }
		
	                       
                    
    const labels1 = yValues1;
    const data1 = {
                    labels: labels1,
                    datasets: [
                                {
                                    label: 'Samples',
                                    data: xValues1,
                                    borderColor: "rgba(253,255,16,1.0)",
                                    backgroundColor: "rgba(0,255,0,0.3)",
                                    
                                }
                            ]
                        };


                       const chart1 = new Chart("IdChartFilesize", {
                            type: 'doughnut',
                            data: data1,
                            options: {
                                responsive: true,
								maintainAspectRatio: true,
								
                                plugins: {
                                    legend:{display:false},
                                    title: {
                                        display: false,
                                        text: 'Filesize',
										color: "rgba(255,255,255,1.0)",
										
                                    }
                                }
                            },
                        });						
						
		




	
	})}
	loadData0();
	

</script>
			</p>
		</div>
		<div class="DivPanel1">
			<h2>DLL Imports</h2>
			<canvas id="IdChartDLLImports" ></canvas>
			
			</p>
		</div>
		
		<div class="DivPanel2">
			<h2>Filetypes</h2>
			
			 <div class="table-container" id="TableFiletype">
        <input type="text" id="search-input1" placeholder="Search filetype"><br/><br/>
		
		<table>
            <thead>
                <tr>
					<th>ID</th>
                    <th>Filetype</th>
                    <th>Count</th>
                    
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
		<div id="pagination1">
        <button id="prev-page1">Prev</button>
        <span id="page-number1">1</span> / <span id="total-pages1">1</span>
        <button id="next-page1">Next</button>
		<span id="count1"></span> 
    <script>
        
        const itemsPerPage1 = 10;
        let currentPage1 = 1;
        let jsonData1 = [];
		let filteredData1 = [];

        
        function loadData1() {
            $.getJSON('filetypes_count.json', function(data) {
                jsonData1 = data;
				filteredData1 = jsonData1;
				
				let count = 0;
			for (const item of filteredData1) {
               count += parseInt(item.count); 
			   
			}
			
				document.getElementById("NSamples").innerHTML=count;
                const totalPages = Math.ceil(filteredData1.length / itemsPerPage1);
                $('#total-pages1').text(totalPages);
                updateTable1();
            });
        }

        
        function updateTable1() {
            const startIndex = (currentPage1 - 1) * itemsPerPage1;
            const endIndex = startIndex + itemsPerPage1;
			const currentPageData = filteredData1.slice(startIndex, endIndex);

            const tableBody = $('#TableFiletype tbody');
            tableBody.empty();
			

            for (const item of currentPageData) {
                tableBody.append(`<tr><td>${item.id}</td><td>${escapeHTML(item.filetype)}</td><td>${item.count}</td></tr>`);
				
			}
			
			let count = 0;
			let celem = 0;
			for (const item of filteredData1) {
               count += parseInt(item.count); 
			   celem +=1;
			}
			$('#count1').text('Total record: ' + celem + ' Total count: ' + count );
     
            $('#page-number1').text(currentPage1);
		}

        
        $('#prev-page1').click(function() {
            if (currentPage1 > 1) {
                currentPage1--;
                updateTable1();
            }
        });

        
        $('#next-page1').click(function() {
            const maxPage = Math.ceil(jsonData1.length / itemsPerPage1);
            if (currentPage1 < maxPage) {
                currentPage1++;
                updateTable1();
            }
        });
		$('#search-input1').on('input', function() {
            const searchTerm = $(this).val().toLowerCase();
            filteredData1 = jsonData1.filter(item => item.filetype.toLowerCase().includes(searchTerm));
            currentPage1 = 1;
			const totalPages = Math.ceil(filteredData1.length / itemsPerPage1);
            $('#total-pages1').text(totalPages);
            updateTable1();
        });

        
        loadData1();
    </script>
	
	</div>
		
		
		
    </div>
	</div>
	<div class="clearfix"></div>
	<div class="DivPanel2">
			<h2>Certificates (publisher and company)</h2>
			
			 <div class="table-container" id="TableCertificate">
        <input type="text" id="search-input2" placeholder="Search certificate"><br/><br/>
		
		<table>
            <thead>
                <tr>
					<th>ID</th>
                    <th>Certificate</th>
                    <th>Count</th>
                    
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
		
		<div id="pagination2">
        <button id="prev-page2">Prev</button>
        <span id="page-number2">1</span> / <span id="total-pages2">1</span>
        <button id="next-page2">Next</button>
		<span id="count2"></span> 
    <script>
        
        const itemsPerPage2 = 20;
        let currentPage2 = 1;
        let jsonData2 = [];
		let filteredData2 =[];

        
        function loadData2() {
            $.getJSON('certificates_count.json', function(data) {
                jsonData2 = data;
				filteredData2 = jsonData2;
                const totalPages = Math.ceil(filteredData2.length / itemsPerPage2);
                $('#total-pages2').text(totalPages);
                updateTable2();
            });
        }

        
        function updateTable2() {
            const startIndex = (currentPage2 - 1) * itemsPerPage2;
            const endIndex = startIndex + itemsPerPage2;
			const currentPageData = filteredData2.slice(startIndex, endIndex);

            const tableBody = $('#TableCertificate tbody');
            tableBody.empty();

            for (const item of currentPageData) {
                tableBody.append(`<tr><td>${item.id}</td><td>${escapeHTML(item.certificate)}</td><td>${item.count}</td></tr>`);
            }
			let count = 0;
			let celem = 0;
			for (const item of filteredData2) {
               count += parseInt(item.count); 
			   celem +=1;
			}
			$('#count2').text('Total record: ' + celem + ' Total count: ' + count );
     

            $('#page-number2').text(currentPage2);
        }

        
        $('#prev-page2').click(function() {
            if (currentPage2 > 1) {
                currentPage2--;
                updateTable2();
            }
        });

        
        $('#next-page2').click(function() {
            const maxPage = Math.ceil(jsonData2.length / itemsPerPage2);
            if (currentPage2 < maxPage) {
                currentPage2++;
                updateTable2();
            }
        });
		$('#search-input2').on('input', function() {
            const searchTerm = $(this).val().toLowerCase();
            filteredData2 = jsonData2.filter(item => item.certificate.toLowerCase().includes(searchTerm));
            currentPage2 = 1;
			const totalPages = Math.ceil(filteredData2.length / itemsPerPage2);
            $('#total-pages2').text(totalPages);
            updateTable2();
        });
        
        loadData2();
    </script>
	</div>
		
    </div>
	</div>
	
	<div class="DivPanel2">
			<h2>Sections</h2>
			
			 <div class="table-container" id="TableSections">
        <input type="text" id="search-input3" placeholder="Search section"><br/><br/>
		
		<table>
            <thead>
                <tr>
					<th>ID</th>
                    <th>Name</th>
                    <th>Count</th>
                    
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
		<div id="pagination3">
        <button id="prev-page3">Prev</button>
        <span id="page-number3">1</span> / <span id="total-pages3">1</span>
        <button id="next-page3">Next</button>
		<span id="count3"></span> 
    <script>
        
        const itemsPerPage3 = 10;
        let currentPage3 = 1;
        let jsonData3 = [];
		let filteredData3 = [];

        
        function loadData3() {
            $.getJSON('sections_count.json', function(data) {
                jsonData3 = data;
				filteredData3 = jsonData3;
                const totalPages = Math.ceil(filteredData3.length / itemsPerPage3);
                $('#total-pages3').text(totalPages);
                updateTable3();
            });
        }

        
        function updateTable3() {
            const startIndex = (currentPage3 - 1) * itemsPerPage3;
            const endIndex = startIndex + itemsPerPage3;
			const currentPageData = filteredData3.slice(startIndex, endIndex);

            const tableBody = $('#TableSections tbody');
            tableBody.empty();

            for (const item of currentPageData) {
                tableBody.append(`<tr><td>${item.id}</td><td><a target='_blank' href='https://www.google.com/search?q="${escapeHTML(item.section)}" PE section'>${escapeHTML(item.section)}</a></td><td>${item.count}</td></tr>`);
            }

			let count = 0;
			let celem = 0;
			for (const item of filteredData3) {
               count += parseInt(item.count); 
			   celem +=1;
			}
			$('#count3').text('Total record: ' + celem + ' Total count: ' + count );
     
            $('#page-number3').text(currentPage3);
        }

        
        $('#prev-page3').click(function() {
            if (currentPage3 > 1) {
                currentPage3--;
                updateTable3();
            }
        });

        
        $('#next-page3').click(function() {
            const maxPage = Math.ceil(jsonData3.length / itemsPerPage3);
            if (currentPage3 < maxPage) {
                currentPage3++;
                updateTable3();
            }
        });
		$('#search-input3').on('input', function() {
            const searchTerm = $(this).val().toLowerCase();
            filteredData3 = jsonData3.filter(item => item.section.toLowerCase().includes(searchTerm));
            currentPage3 = 1;
			const totalPages = Math.ceil(filteredData3.length / itemsPerPage3);
            $('#total-pages3').text(totalPages);
            updateTable3();
        });
        
        loadData3();
    </script>
	</div>
		
    </div>
	</div>
	
	
	<div class="DivPanel2">
			<h2>Resource type</h2>
			
			 <div class="table-container" id="TableResources">
        <input type="text" id="search-input4" placeholder="Search resource type"><br/><br/>
		
		<table>
            <thead>
                <tr>
					<th>ID</th>
                    <th>Type</th>
                    <th>Count</th>
                    
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
		<div id="pagination4">
        <button id="prev-page4">Prev</button>
        <span id="page-number4">1</span> / <span id="total-pages4">1</span>
        <button id="next-page4">Next</button>
		<span id="count4"></span> 
    <script>
        
        const itemsPerPage4 = 10;
        let currentPage4 = 1;
        let jsonData4 = [];
		let filteredData4 = [];
        
        function loadData4() {
            $.getJSON('resources_count.json', function(data) {
                jsonData4 = data;
				filteredData4 = jsonData4;
                const totalPages = Math.ceil(filteredData4.length / itemsPerPage4);
                $('#total-pages4').text(totalPages);
                updateTable4();
            });
        }

        
        function updateTable4() {
            const startIndex = (currentPage4 - 1) * itemsPerPage4;
            const endIndex = startIndex + itemsPerPage4;
			const currentPageData = filteredData4.slice(startIndex, endIndex);

            const tableBody = $('#TableResources tbody');
            tableBody.empty();

            for (const item of currentPageData) {
                tableBody.append(`<tr><td>${item.id}</td><td>${escapeHTML(item.resource)}</td><td>${item.count}</td></tr>`);
            }
			let count = 0;
			let celem = 0;
			for (const item of filteredData4) {
               count += parseInt(item.count); 
			   celem +=1;
			}
			$('#count4').text('Total record: ' + celem + ' Total count: ' + count );
     

            $('#page-number4').text(currentPage4);
        }

        
        $('#prev-page4').click(function() {
            if (currentPage4 > 1) {
                currentPage4--;
                updateTable4();
            }
        });

        
        $('#next-page4').click(function() {
            const maxPage = Math.ceil(jsonData4.length / itemsPerPage4);
            if (currentPage4 < maxPage) {
                currentPage4++;
                updateTable4();
            }
        });
		$('#search-input4').on('input', function() {
            const searchTerm = $(this).val().toLowerCase();
            filteredData4 = jsonData4.filter(item => item.resource.toLowerCase().includes(searchTerm));
            currentPage4 = 1;
			const totalPages = Math.ceil(filteredData4.length / itemsPerPage4);
            $('#total-pages4').text(totalPages);
            updateTable4();
        });

        
        loadData4();
    </script>
	</div>
	
    </div>
	</div>
	
	<div class="DivPanel2">
			<h2>DLL Imports</h2>
			
			 <div class="table-container" id="TableImports">
        <input type="text" id="search-input5" placeholder="Search import"><br/><br/>
		
		<table>
            <thead>
                <tr>
					<th>ID</th>
                    <th>DLL</th>
                    <th>Count</th>
                    
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
		<div id="pagination5">
        <button id="prev-page5">Prev</button>
        <span id="page-number5">1</span> / <span id="total-pages5">1</span>
        <button id="next-page5">Next</button>
		<span id="count5"></span> 
    <script>
        
        const itemsPerPage5 = 15;
        let currentPage5 = 1;
        let jsonData5 = [];
		let filteredData5 = [];

        
        function loadData5() {
            $.getJSON('imports_count.json', function(data) {
                jsonData5 = data;
				filteredData5 = jsonData5;
                const totalPages = Math.ceil(filteredData5.length / itemsPerPage5);
                $('#total-pages5').text(totalPages);
                updateTable5();
				
				
				
				
	var yValues2 = [];
	var xValues2 = [];
	const slc5 = jsonData5.slice(0, 20);
	for (const item of slc5) {
			xValues2.push(item.count);
			yValues2.push(item.import);
                
      }
	
	
	
	

	

	const labels2 = yValues2;
    const data2 = {
                    labels: labels2,
                    datasets: [
                                {
                                    label: 'Samples',
                                    data: xValues2,
                                    borderColor: "rgba(255,16,101,1.0)",
                                    backgroundColor: "rgba(0,255,0,0.3)",
                                    
                                }
                            ]
                        };


                       const chart2 = new Chart("IdChartDLLImports", {
                            type: 'line',
                            data: data2,
                            options: {
                                responsive: true,
								maintainAspectRatio: true,
								scales: {
      y: {
        ticks: { color: 'white', beginAtZero: true }
      },
      x: {
        ticks: { color: 'white', beginAtZero: true,
		autoSkip: false,
                    maxRotation: 90,
                    minRotation: 90 }
      }
    },
                                plugins: {
                                    legend:{display:false},
                                    title: {
                                        display: false,
                                        text: 'Samples',
										color: "rgba(255,255,255,1.0)"
                                    }
                                }
                            },
                        });



				
								
				
            });
        }

        
        function updateTable5() {
            const startIndex = (currentPage5 - 1) * itemsPerPage5;
            const endIndex = startIndex + itemsPerPage5;
			const currentPageData = filteredData5.slice(startIndex, endIndex);

            const tableBody = $('#TableImports tbody');
            tableBody.empty();

            for (const item of currentPageData) {
                tableBody.append(`<tr><td>${item.id}</td><td><a href='https://www.google.com/search?q="${escapeHTML(item.import)}"' target='_blank'>${escapeHTML(item.import)}</a></td><td>${item.count}</td></tr>`);
            }
			let count = 0;
			let celem = 0;
			for (const item of filteredData5) {
               count += parseInt(item.count); 
			   celem +=1;
			}
			$('#count5').text('Total record: ' + celem + ' Total count: ' + count );
     
	 
            $('#page-number5').text(currentPage5);
        }

        
        $('#prev-page5').click(function() {
            if (currentPage5 > 1) {
                currentPage5--;
                updateTable5();
            }
        });

        
        $('#next-page5').click(function() {
            const maxPage = Math.ceil(jsonData5.length / itemsPerPage5);
            if (currentPage5 < maxPage) {
                currentPage5++;
                updateTable5();
            }
        });
		$('#search-input5').on('input', function() {
            const searchTerm = $(this).val().toLowerCase();
            filteredData5 = jsonData5.filter(item => item.import.toLowerCase().includes(searchTerm));
            currentPage5 = 1;
			const totalPages = Math.ceil(filteredData5.length / itemsPerPage5);
            $('#total-pages5').text(totalPages);
            updateTable5();
        });
        
        loadData5();
    </script>
	</div>
	
    </div>
	</div>
	
	
	
	<div class="DivPanel2">
			<h2>Function Imports</h2>
			 <div class="table-container" id="TableFunctionsImports">
        <input type="text" id="search-input6" placeholder="Search function"><br/><br/>
		<table>
            <thead>
                <tr>
					<th>ID</th>
                    <th>Function</th>
                    <th>Count</th>
                    
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
		<div id="pagination6">
        <button id="prev-page6">Prev</button>
        <span id="page-number6">1</span> / <span id="total-pages6">1</span>
        <button id="next-page6">Next</button>
		<span id="count6"></span> 
    <script>
         
        const itemsPerPage6 = 20;
        let currentPage6 = 1;
        let jsonData6 = [];
		let filteredData6 = [];

        
        function loadData6() {
            $.getJSON('functions_count.json', function(data) {
                jsonData6 = data;
				filteredData6 = jsonData6;
                const totalPages = Math.ceil(filteredData6.length / itemsPerPage6);
                $('#total-pages6').text(totalPages);
                updateTable6();
            });
        }

        
        function updateTable6() {
            const startIndex = (currentPage6 - 1) * itemsPerPage6;
            const endIndex = startIndex + itemsPerPage6;
			const currentPageData = filteredData6.slice(startIndex, endIndex);

            const tableBody = $('#TableFunctionsImports tbody');
            tableBody.empty();

            for (const item of currentPageData) {
                tableBody.append(`<tr><td>${item.id}</td><td><a target='_blank' href='https://www.google.com/search?q="${escapeHTML(item.function.replace('!','" "'))}"'>${escapeHTML(item.function)}</a></td><td>${item.count}</td></tr>`);
            }
			let count = 0;
			let celem = 0;
			for (const item of filteredData6) {
               count += parseInt(item.count); 
			   celem +=1;
			}
			$('#count6').text('Total record: ' + celem + ' Total count: ' + count );
     

            $('#page-number6').text(currentPage6);
        }

        
        $('#prev-page6').click(function() {
            if (currentPage6 > 1) {
                currentPage6--;
                updateTable6();
            }
        });

        
        $('#next-page6').click(function() {
            const maxPage = Math.ceil(jsonData6.length / itemsPerPage6);
            if (currentPage6 < maxPage) {
                currentPage6++;
                updateTable6();
            }
        });
		$('#search-input6').on('input', function() {
            const searchTerm = $(this).val().toLowerCase();
            filteredData6 = jsonData6.filter(item => item.function.toLowerCase().includes(searchTerm));
            currentPage6 = 1;
			const totalPages = Math.ceil(filteredData6.length / itemsPerPage6);
            $('#total-pages6').text(totalPages);
            updateTable6();
        });
        
        loadData6();
    </script>
	</div>
    </div>
	</div>
	
	
	<div class="DivPanel2">
			<h2>Function Exports</h2>
			 <div class="table-container" id="TableFunctionsExports">
        <input type="text" id="search-input7" placeholder="Search export"><br/><br/>
		<table>
            <thead>
                <tr>
					<th>ID</th>
                    <th>Function</th>
                    <th>Count</th>
                    
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
		<div id="pagination7">
        <button id="prev-page7">Prev</button>
        <span id="page-number7">1</span> / <span id="total-pages7">1</span>
        <button id="next-page7">Next</button>
		<span id="count7"></span> 
    <script>
        
        const itemsPerPage7 = 10;
        let currentPage7 = 1;
        let jsonData7 = [];
		let filteredData7 = [];

        
        function loadData7() {
            $.getJSON('exports_count.json', function(data) {
                jsonData7 = data;
				filteredData7 = jsonData7; 
                const totalPages = Math.ceil(filteredData7.length / itemsPerPage7);
				$('#total-pages7').text(totalPages);
                updateTable7();
            });
        }

        
        function updateTable7() {
            const startIndex = (currentPage7 - 1) * itemsPerPage7;
            const endIndex = startIndex + itemsPerPage7;
			const currentPageData = filteredData7.slice(startIndex, endIndex);

            const tableBody = $('#TableFunctionsExports tbody');
            tableBody.empty();

            for (const item of currentPageData) {
                tableBody.append(`<tr><td>${item.id}</td><td><a target='_blank' href='https://www.google.com/search?q="${escapeHTML(item.export)}" function export PE'>${escapeHTML(item.export)}</a></td><td>${item.count}</td></tr>`);
            }
			let count = 0;
			let celem = 0;
			for (const item of filteredData7) {
               count += parseInt(item.count); 
			   celem +=1;
			}
			$('#count7').text('Total record: ' + celem + ' Total count: ' + count );
     

            $('#page-number7').text(currentPage7);
        }

        
        $('#prev-page7').click(function() {
            if (currentPage7 > 1) {
                currentPage7--;
                updateTable7();
            }
        });

        
        $('#next-page7').click(function() {
            const maxPage = Math.ceil(jsonData7.length / itemsPerPage7);
            if (currentPage7 < maxPage) {
                currentPage7++;
                updateTable7();
            }
        });
		$('#search-input7').on('input', function() {
            const searchTerm = $(this).val().toLowerCase();
            filteredData7 = jsonData7.filter(item => item.export.toLowerCase().includes(searchTerm));
            currentPage7 = 1;
			const totalPages = Math.ceil(filteredData7.length / itemsPerPage7);
            $('#total-pages7').text(totalPages);
            updateTable7();
        });
        
        loadData7();
    </script>
	</div>
    </div>
	</div>
	
	<div class="DivPanel2">
			<h2>Function call sequences (>=3)</h2>
			 <div class="table-container2" id="TableFunctionsCalls">
        <input type="text" id="search-input8" placeholder="Search function call"><br/><br/>
    
		<table>
            <thead>
                <tr>
					<th>ID</th>
                    <th>Functions</th>
                    <th>Count</th>
                    
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
		<div id="pagination8">
        <button id="prev-page8">Prev</button>
        <span id="page-number8">1</span> / <span id="total-pages8">1</span>
        <button id="next-page8">Next</button>
		<span id="count8"></span> 
    <script>
        
        const itemsPerPage8 = 25;
        let currentPage8 = 1;
        let jsonData8 = [];
		let filteredData8 = [];

        
        function loadData8() {
            $.getJSON('xrefs_count.json', function(data) {
                jsonData8 = data;
				filteredData8 = jsonData8; 
                const totalPages = Math.ceil(filteredData8.length / itemsPerPage8);
                $('#total-pages8').text(totalPages);
                updateTable8();
            });
        }

        
        function updateTable8() {
            const startIndex = (currentPage8 - 1) * itemsPerPage8;
            const endIndex = startIndex + itemsPerPage8;
			const currentPageData = filteredData8.slice(startIndex, endIndex);

            const tableBody = $('#TableFunctionsCalls tbody');
            tableBody.empty();

            for (const item of currentPageData) {
				
				
				const cleanedString = escapeHTML(item.xref).replace(/\[|\]|'/g, '').replace(/&#039;/g, '');
				const elementsArray = cleanedString.split(', ');
				var lnks ="";

				elementsArray.forEach((element) => {
				
					
					lnks= lnks + "<a target='_blank' href='https://www.google.com/search?q=\"" + element.trim().replace('!','" "').replace("'","") + '\"\'>'+ element.trim() + '</a>  ';
				});
			
                tableBody.append(`<tr><td>${item.id}</td><td>${lnks}</td><td>${item.count}</td></tr>`);
            }
			let count = 0;
			let celem = 0;
			for (const item of filteredData8) {
               count += parseInt(item.count); 
			   celem +=1;
			}
			$('#count8').text('Total record: ' + celem + ' Total count: ' + count );
     

            $('#page-number8').text(currentPage8);
        }

        
        $('#prev-page8').click(function() {
            if (currentPage8 > 1) {
                currentPage8--;
                updateTable8();
            }
        });

        
        $('#next-page8').click(function() {
            const maxPage = Math.ceil(jsonData8.length / itemsPerPage8);
            if (currentPage8 < maxPage) {
                currentPage8++;
                updateTable8();
            }
        });
		$('#search-input8').on('input', function() {
            const searchTerm = $(this).val().toLowerCase();
            filteredData8 = jsonData8.filter(item => item.xref.toLowerCase().includes(searchTerm));
            currentPage8 = 1;
			const totalPages = Math.ceil(filteredData8.length / itemsPerPage8);
            $('#total-pages8').text(totalPages);
            updateTable8();
        });
        
        loadData8();
    </script>
	</div>
    </div>
	</div>
	
	
	<div class="DivPanel2">
			<h2>Strings</h2>
			<p>>5 chars AND >= 30 related samples, excluding DLL and DLL function names used by the same sample.
			 <div class="table-container2" id="TableStrings">
         <input type="text" id="search-input9" placeholder="Search string"><br/><br/>
		<table>
            <thead>
                <tr>
					<th>ID</th>
                    <th>String</th>
                    <th>Count</th>
                    
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
		<div id="pagination9">
        <button id="prev-page9">Prev</button>
        <span id="page-number9">1</span> / <span id="total-pages9">1</span>
        <button id="next-page9">Next</button>
		<span id="count9"></span> 
    <script>
        
        const itemsPerPage9 = 50;
        let currentPage9 = 1;
        let jsonData9 = [];
		let filteredData9 = [];

        
        function loadData9() {
            $.getJSON('strings_count.json', function(data) {
                jsonData9 = data;
                filteredData9 = jsonData9; 
                const totalPages = Math.ceil(filteredData9.length / itemsPerPage9);
                $('#total-pages9').text(totalPages);
                updateTable9();
            });
        }

        
        function updateTable9() {
            const startIndex = (currentPage9 - 1) * itemsPerPage9;
            const endIndex = startIndex + itemsPerPage9;
			const currentPageData = filteredData9.slice(startIndex, endIndex);

            const tableBody = $('#TableStrings tbody');
            tableBody.empty();

            for (const item of currentPageData) {
                tableBody.append(`<tr><td>${item.id}</td><td><a target='_blank' href='https://www.google.com/search?q="${escapeHTML(item.string)}" PE string'>${escapeHTML(item.string)}</a></td><td>${item.count}</td></tr>`);
            }
			let count = 0;
			let celem = 0;
			for (const item of filteredData9) {
               count += parseInt(item.count); 
			   celem +=1;
			}
			$('#count9').text('Total record: ' + celem + ' Total count: ' + count );
     
            $('#page-number9').text(currentPage9);
        }

        
        $('#prev-page9').click(function() {
            if (currentPage9 > 1) {
                currentPage9--;
                updateTable9();
            }
        });

        
        $('#next-page9').click(function() {
            const maxPage = Math.ceil(jsonData9.length / itemsPerPage9);
            if (currentPage9 < maxPage) {
                currentPage9++;
                updateTable9();
            }
        });
		$('#search-input9').on('input', function() {
            const searchTerm = $(this).val().toLowerCase();
            filteredData9 = jsonData9.filter(item => item.string.toLowerCase().includes(searchTerm));
            currentPage9 = 1;
			const totalPages = Math.ceil(filteredData9.length / itemsPerPage9);
            $('#total-pages9').text(totalPages);
            updateTable9();
        });
        
        loadData9();
    </script>
	</div>
    </div>
	</div>
	
	
   </div>
		<div class="clearfix"></div>
		
	</div>
	



</body>
</html>